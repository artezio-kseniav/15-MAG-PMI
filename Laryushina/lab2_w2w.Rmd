---
title: "lab2_w2w"
author: "Julia"
date: "10 June 2016"
output: html_document
---
Необходимые библиотеки:
```{r message=FALSE}
require(wordVectors)
require(magrittr)
require(parallel)
require(readr)
require(R2HTML)
```
```{r message=FALSE, include=FALSE}
vectors <- read.vectors("output/w2w.bin")
```
```{r message=FALSE, warning=FALSE, eval = FALSE}
setwd(paste0(getwd(), "/karpov/cl/"))
threads = detectCores() - 1 
data_path <- "data/20news-18828/alt.atheism/"
```

Подготовим данные для модели (prep_word2vec) и  натренируем модель (train_word2vec).
```{r message=FALSE, warning=FALSE, eval = FALSE}
combined <- prep_word2vec(data_path, dest = "output/w2w.rdata", lowercase = T)
model <- train_word2vec("output/w2w.rdata", threads = threads, 
                        vectors = 300, window = 10, min_count = 10, cbow = 1)
vectors <- read.vectors("output/w2w.bin")
```

Раз уж в корпус затесалось загадочное слово "koresh", посмотрим, кто же наш "koresh".
```{r message=FALSE, warning=FALSE}
nearest_to(vectors, vectors[["koresh"]])
```

Попробуем сделать нечто более осмысленное и получить нечто близкое к каноническому king:man::queen:woman.
```{r message=FALSE, warning=FALSE}
nearest_to(vectors, vectors[["god"]] - vectors[["man"]] + vectors[["woman"]])
nearest_to(vectors, vectors[["god"]] - vectors[["he"]] + vectors[["she"]])
```
Видимо, в атеистских текстах богини не фигурируют.

Найдем максимально близкие к Богу слова.
```{r message=FALSE, warning=FALSE}
god_names = nearest_to(vectors, vectors[[c("god","gods","lord","master")]], 10)
plot(filter_to_rownames(vectors, names(god_names)))
```
Санта?

Попробуем удалить всяческую семантическую близость с полом.
```{r message=FALSE, warning=FALSE}
genderless = vectors[["god"]] %>%
  reject(vectors[["he"]]) %>% 
  reject(vectors[["she"]])
vectors %>% nearest_to(genderless)
```
...и получим ответ "ну, это уже фантастика!" (supernatural).

И напоследок попробуем отфильтровать зло =)
```{r message=FALSE, warning=FALSE}
evilless = vectors[["god"]] %>%
  reject(vectors[["satan"]]) %>% 
  reject(vectors[["evil"]]) %>% 
  reject(vectors[["she"]])
vectors %>% nearest_to(evilless)
```

Остается только сила и колледж! И болезни.